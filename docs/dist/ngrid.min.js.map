{"version":3,"sources":["docs/dist/ngrid.js"],"names":["window","angular","module","console","log","constant","SUM","MIN","MAX","AVG","directive","$window","$templateCache","$templateRequest","$interpolate","$compile","$filter","$timeout","Utils","trimWhiteSpace","string","replace","priority","restrict","templateUrl","transclude","controller","$transclude","$attrs","clone","scope","html","Array","prototype","slice","call","filter","node","nodeType","test","nodeValue","map","outerHTML","join","template","link","element","attributes","model","updateRows","from","to","count","total","layout","rows","dirty","Math","ceil","grid","height","cell","floor","scroll","y","max","min","length","updateCols","cols","width","x","getCell","i","item","r","c","$row","$col","$index","$scope","$new","$i","$r","$c","row","col","drawCells","visibles","targetElement","tableElement","forEach","$$phase","$digest","compiled","cloned","$element","append","push","getDate","undefined","adate","Date","today","getTime","setDate","CALENDAR_SIZE","getDay","day","$key","round","oneday","$date","$day","$dayName","$week","$workingDay","$weekEnd","$month","$monthName","$year","getAbsoluteCol","visibleDays","getWeek","week","$weekName","weekName","$from","$to","getMonth","month","monthName","year","drawHeaders","CALENDAR","visibleMonths","visibleWeeks","templateDay","daysElement","weeks","months","lastWeek","lastMonth","parseInt","templateWeek","weeksElement","templateMonth","monthsElement","update","render","redraw","style","table","transform","mx","wx","nodeTableInner","has","nodeHeaderInner","value","WebkitTransform","MozTransform","OTransform","MsTransform","onRows","addClass","removeClass","nodeSpacer","onCols","scrollToColumn","resize","nodeTable","scrollLeft","doScroll","scrollToX","scrollToY","scrollTop","scrollTo","$layout","onScroll","isFunction","WW","innerWidth","document","documentElement","clientWidth","body","WH","innerHeight","clientHeight","offsetWidth","offsetHeight","onResize","obj","info","JSON","stringify","nodeInfo","innerHTML","onStart","e","down","getTouch","sx","sy","addDragListeners","onMove","move","diff","difference","dragging","power","onEnd","removeDragListeners","on","off","removeListeners","nodeHeader","ngridCalendar","nodeElement","querySelector","nodeHeaderMonths","nodeHeaderWeeks","nodeHeaderDays","cellWidth","cellHeight","monthWidth","monthHeight","weekWidth","weekHeight","dayWidth","dayHeight","setHours","setMinutes","setSeconds","getTimezoneOffset","$on","$watchCollection","ngridRows","oldValue","setTimeout","$watch","ngridCols","ngrid","isObject","keys","key","toTitleCase","str","txt","charAt","toUpperCase","substr","toLowerCase","indexOf","split","splitted","firstName","shift","lastName","legacyFilter","cost","currency","ratio","formatting","precision","unit","hours","minutes","label","format","timezone","placeholder","parseTime","parseHour","val","factory","cycle","k","a","b","d","ff","gg","hh","ii","add32","cmn","q","s","t","md51","n","state","md5blk","substring","tail","charCodeAt","md5blks","rhex","j","hex_chr","hex","Md5","encode","lsw","$controller","Vector","previous","type","touch","event","originalEvent","touches","changedTouches","pageX","pageY","getRelativeTouch","point","rect","getBoundingClientRect","left","top","getClosest","el","selector","matchesFn","parent","some","fn","parentElement","getClosestElement","target","throttle","func","wait","options","context","args","result","timeout","later","leading","getNow","apply","now","remaining","this","arguments","clearTimeout","trailing","where","array","query","found","compileController","data","contents","extend","controllerAs","children","reverseSortOn","prepend","expression","formatted","index","reducer","o","reducerSetter","reducerAdder","lastTime","vendors","requestAnimationFrame","cancelAnimationFrame","callback","currTime","timeToCall","id","reduce","Object","defineProperty","TypeError","len","ua","navigator","userAgent","safari","msie","chrome","mobile","toMd5","getElementsByTagName","make","size","sqrt","normalize","l","incidence","atan2","distance","cross","abs","towards","friction","add","copy","toString","app","err","run","put"],"mappings":"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","file":"ngrid.min.js","sourcesContent":["\r\n(function(window, angular) {'use strict';\r\n\n/* global angular */\r\n\r\nvar module = angular.module('ngrid', ['ng', 'ngSanitize']);\r\n\n/* global angular, module */\r\n\r\nwindow.console ? null : window.console = { log: function () { } };\r\n\r\nmodule.constant('ngridModes', {\r\n    SUM: 1,\r\n    MIN: 2,\r\n    MAX: 3,\r\n    AVG: 4,\r\n});\r\n\n/* global angular, module */\r\n\n/* global angular, module */\r\n\r\nmodule.directive('ngrid', ['$window', '$templateCache', '$templateRequest', '$interpolate', '$compile', '$filter', '$timeout', 'Utils', function ($window, $templateCache, $templateRequest, $interpolate, $compile, $filter, $timeout, Utils) {\r\n    // polyfill for trim >= IE9\r\n    function trimWhiteSpace(string) {\r\n        return string.replace(/^\\s+|\\s+$/gm, '');\r\n    }\r\n    return {\r\n        priority: 1,\r\n        restrict: 'A',\r\n        replace: true,\r\n        /*\r\n        // with scope attributes watch won't work anymore\r\n        scope: {},\r\n        */\r\n        templateUrl: 'ngrid/partials/ngrid',\r\n        transclude: true,\r\n        controller: ['$transclude', '$attrs', function ($transclude, $attrs) {\r\n            $transclude(function (clone, scope) {\r\n                var html = Array.prototype.slice.call(clone).filter(function (node) {\r\n                    // remove empty text nodes\r\n                    return (node.nodeType !== 3 || /\\S/.test(node.nodeValue));\r\n                }).map(function (node) {\r\n                    return trimWhiteSpace(node.outerHTML);\r\n                });\r\n                html = html.join('');\r\n                $attrs.template = html;\r\n            });\r\n        }],\r\n        link: function (scope, element, attributes, model, transclude) {\r\n            var CALENDAR_SIZE = 365;\r\n            var CALENDAR = attributes.ngridCalendar !== undefined;\r\n            if (CALENDAR) {\r\n                element.addClass('calendar');\r\n            }\r\n\r\n            // console.log(attributes);\r\n            var template = attributes.template;\r\n            attributes.template = null;\r\n            // console.log('template', template);\r\n\r\n            var templateMonth = '<div class=\"ngrid-month\"><span class=\"monthName\" ng-bind=\"$monthName\"></span> <span class=\"year\" ng-bind=\"$year\"></span></div>';\r\n            var templateWeek = '<div class=\"ngrid-week\">W <span class=\"weekName\" ng-bind=\"$weekName\"></span></div>';\r\n            var templateDay = '<div class=\"ngrid-day\" ng-class=\"{ weekend: $weekEnd }\"><span class=\"dayName\" ng-bind=\"$dayName\"></span><span class=\"day\" ng-bind=\"$day\"></span></div>';\r\n\r\n            var nodeElement = element[0],\r\n                nodeHeader = nodeElement.querySelector('.ngrid-header'),\r\n                nodeHeaderInner = nodeElement.querySelector('.ngrid-header>.ngrid-inner'),\r\n                nodeHeaderMonths = nodeElement.querySelector('.ngrid-header>.ngrid-inner>.ngrid-months'),\r\n                nodeHeaderWeeks = nodeElement.querySelector('.ngrid-header>.ngrid-inner>.ngrid-weeks'),\r\n                nodeHeaderDays = nodeElement.querySelector('.ngrid-header>.ngrid-inner>.ngrid-days'),\r\n                nodeTable = nodeElement.querySelector('.ngrid-table'),\r\n                nodeTableInner = nodeElement.querySelector('.ngrid-table>.ngrid-inner'),\r\n                nodeSpacer = nodeElement.querySelector('.ngrid-spacer'),\r\n                nodeInfo = nodeElement.querySelector('.ngrid-info'),\r\n                monthsElement = angular.element(nodeHeaderMonths),\r\n                weeksElement = angular.element(nodeHeaderWeeks),\r\n                daysElement = angular.element(nodeHeaderDays),\r\n                tableElement = angular.element(nodeTableInner),\r\n                layout = scope.layout = {\r\n                    grid: { width: 0, height: 0 },\r\n                    table: { x: 0, y: 0, width: 0, height: 0 },\r\n                    scroll: { x: 0, y: 0 },\r\n                    rows: {}, cols: {},\r\n                    visibleMonths: [], visibleWeeks: [], visibleDays: [], visibles: [],\r\n                    cell: {\r\n                        width: attributes.cellWidth !== undefined ? parseInt(attributes.cellWidth) : 40,\r\n                        height: attributes.cellHeight !== undefined ? parseInt(attributes.cellHeight) : 40,\r\n                    },\r\n                    month: {\r\n                        width: attributes.monthWidth !== undefined ? parseInt(attributes.monthWidth) : 40,\r\n                        height: attributes.monthHeight !== undefined ? parseInt(attributes.monthHeight) : 25,\r\n                    },\r\n                    week: {\r\n                        width: attributes.weekWidth !== undefined ? parseInt(attributes.weekWidth) : 40,\r\n                        height: attributes.weekHeight !== undefined ? parseInt(attributes.weekHeight) : 25,\r\n                    },\r\n                    day: {\r\n                        width: attributes.dayWidth !== undefined ? parseInt(attributes.dayWidth) : 40,\r\n                        height: attributes.dayHeight !== undefined ? parseInt(attributes.dayHeight) : 40,\r\n                    }\r\n                },\r\n                rows, cols, weeks, months;\r\n\r\n            function updateRows() {\r\n                var total = layout.rows.total,\r\n                    dirty = false, from, to, count;\r\n                if (total > 0) {\r\n                    count = Math.ceil(layout.grid.height / layout.cell.height) + 1;\r\n                    from = Math.floor(layout.scroll.y / layout.cell.height);\r\n                    from = Math.max(0, Math.min(total - count + 1, from));\r\n                    to = Math.min(rows.length, from + count);\r\n                } else {\r\n                    count = to = 1;\r\n                    from = 0;\r\n                }\r\n                dirty = (from !== layout.rows.from) || (to !== layout.rows.to);\r\n                layout.rows.dirty = dirty;\r\n                layout.rows.from = from;\r\n                layout.rows.to = to;\r\n                layout.rows.count = count;\r\n            }\r\n\r\n            function updateCols() {\r\n                var total = layout.cols.total,\r\n                    dirty = false, from, to, count;\r\n                if (total > 0) {\r\n                    count = Math.ceil(layout.grid.width / layout.cell.width) + 1;\r\n                    from = Math.floor(layout.scroll.x / layout.cell.width);\r\n                    from = Math.max(0, Math.min(total - count + 1, from));\r\n                    to = Math.min(cols.length, from + count);\r\n                } else {\r\n                    count = to = 1;\r\n                    from = 0;\r\n                }\r\n                dirty = (from !== layout.cols.from) || (to !== layout.cols.to);\r\n                layout.cols.dirty = dirty;\r\n                layout.cols.from = from;\r\n                layout.cols.to = to;\r\n                layout.cols.count = count;\r\n            }\r\n\r\n            function getCell(i, item) {\r\n                var r = Math.floor(i / layout.cols.count);\r\n                var c = (i % layout.cols.count);\r\n                var $row = layout.rows.from + r;\r\n                var $col = layout.cols.from + c;\r\n                var $index = $row * layout.cols.total + $col;\r\n                var $scope = item ? item.scope : scope.$new();\r\n                $scope.$i = i;\r\n                $scope.$r = r;\r\n                $scope.$c = c;\r\n                $scope.$index = $index;\r\n                $scope.$row = $row;\r\n                $scope.$col = $col;\r\n                $scope.row = rows ? rows[$row] : null;\r\n                $scope.col = cols ? cols[$col] : null;\r\n                return $scope;\r\n            }\r\n\r\n            function drawCells() {\r\n                // console.log('drawCells', template);\r\n                var count = layout.rows.count * layout.cols.count,\r\n                    visibles = layout.visibles,\r\n                    targetElement = tableElement;\r\n                if (layout.rows.dirty || layout.cols.dirty) {\r\n                    angular.forEach(visibles, function (item, i) {\r\n                        if (i < count) {\r\n                            var $scope = getCell(i, item);\r\n                            if (!$scope.$$phase) {\r\n                                $scope.$digest();\r\n                            }\r\n                        }\r\n                    });\r\n                    // console.log('dirty', Math.min(visibles.length, count));\r\n                }\r\n                while (visibles.length < count) {\r\n                    var $scope = getCell(visibles.length);\r\n                    var compiled = $compile(template)($scope, function (cloned) {\r\n                        compiled = cloned;\r\n                    });\r\n                    var $element = angular.element(compiled);\r\n                    targetElement.append($element);\r\n                    visibles.push({\r\n                        element: $element,\r\n                        scope: $scope,\r\n                    });\r\n                }\r\n            }\r\n\r\n            var today = new Date();\r\n            today.setHours(0);\r\n            today.setMinutes(0);\r\n            today.setSeconds(0);\r\n            var offset = today.getTimezoneOffset() * 60 * 1000;\r\n            var oneday = 24 * 60 * 60 * 1000;\r\n            function getDate(col) {\r\n                if (col !== undefined) {\r\n                    var adate = new Date(today.getTime());\r\n                    adate.setDate(adate.getDate() - CALENDAR_SIZE + col);\r\n                    return adate;\r\n                }\r\n            }\r\n\r\n            function getDay(i, item) {\r\n                var $c = i;\r\n                var $col = layout.cols.from + $c;\r\n                var $index = $col;\r\n                var $scope = item ? item.scope : scope.$new();\r\n                $scope.$c = $c;\r\n                $scope.$col = $col;\r\n                $scope.$index = $index;\r\n                var adate = getDate($col), day = adate.getDay();\r\n                $scope.$key = Math.round(adate.getTime() / oneday) * oneday; // + offset;\r\n                $scope.$date = adate;\r\n                $scope.$day = $filter('date')(adate, 'd');\r\n                $scope.$dayName = $filter('date')(adate, 'EEE');\r\n                $scope.$week = $filter('date')(adate, 'ww');\r\n                $scope.$workingDay = (day > 0 && day < 6);\r\n                $scope.$weekEnd = !$scope.$workingDay;\r\n                $scope.$month = $filter('date')(adate, 'MM');\r\n                $scope.$monthName = $filter('date')(adate, 'MMM');\r\n                $scope.$year = $filter('date')(adate, 'yy');\r\n                return $scope;\r\n            }\r\n            \r\n            function getAbsoluteCol(col) {\r\n                // console.log('getAbsoluteCol', col);\r\n                var i = col - layout.cols.from;\r\n                var item = layout.visibleDays[i];\r\n                return getDay(i, item);\r\n            }\r\n\r\n            function getWeek(i, week, item) {\r\n                var $scope = item ? item.scope : scope.$new();                \r\n                $scope.$week = week.week;\r\n                $scope.$weekName = week.weekName;\r\n                $scope.$from = week.from;\r\n                $scope.$to = week.to;\r\n                return $scope;\r\n            }\r\n\r\n            function getMonth(i, month, item) {\r\n                var $scope = item ? item.scope : scope.$new();\r\n                $scope.$month = month.month;\r\n                $scope.$monthName = month.monthName;\r\n                $scope.$year = month.year;\r\n                $scope.$from = month.from;\r\n                $scope.$to = month.to;\r\n                return $scope;\r\n            }\r\n\r\n            function drawHeaders() {\r\n                // console.log('drawCells', template);\r\n                if (CALENDAR) {\r\n                    var count = layout.cols.count,\r\n                        visibleMonths = layout.visibleMonths,\r\n                        visibleWeeks = layout.visibleWeeks,\r\n                        visibleDays = layout.visibleDays;\r\n                    if (layout.cols.dirty) {\r\n                        angular.forEach(visibleDays, function (item, i) {\r\n                            if (i < count) {\r\n                                var $scope = getDay(i, item);\r\n                                if (!$scope.$$phase) {\r\n                                    $scope.$digest();\r\n                                }\r\n                            }\r\n                        });\r\n                        // console.log('dirty', Math.min(visibles.length, count));\r\n                    }\r\n                    while (visibleDays.length < count) {\r\n                        var $scope = getDay(visibleDays.length);\r\n                        var compiled = $compile(templateDay)($scope, function (cloned) {\r\n                            compiled = cloned;\r\n                        });\r\n                        var $element = angular.element(compiled);\r\n                        daysElement.append($element);\r\n                        visibleDays.push({\r\n                            element: $element,\r\n                            scope: $scope,\r\n                        });\r\n                    }\r\n                    weeks = [];\r\n                    months = [];\r\n                    var lastWeek = null, lastMonth = null;\r\n                    angular.forEach(visibleDays, function (day, i) {\r\n                        if (i < count) {\r\n                            var week = parseInt(day.scope.$week);\r\n                            if (week !== lastWeek) {\r\n                                if (weeks.length) {\r\n                                    weeks[weeks.length - 1].to = i;\r\n                                }\r\n                                weeks.push({\r\n                                    week: week,\r\n                                    weekName: day.scope.$week,\r\n                                    from: i,\r\n                                    to: i,\r\n                                });\r\n                                lastWeek = week;\r\n                            }\r\n                            var month = parseInt(day.scope.$month);\r\n                            if (month !== lastMonth) {\r\n                                if (months.length) {\r\n                                    months[months.length - 1].to = i;\r\n                                }\r\n                                months.push({\r\n                                    month: month,\r\n                                    monthName: day.scope.$monthName,\r\n                                    year: day.scope.$year,\r\n                                    from: i,\r\n                                    to: i,\r\n                                });\r\n                                lastMonth = month;\r\n                            }\r\n                        }\r\n                    });\r\n                    if (weeks.length > 0) {\r\n                        weeks[weeks.length - 1].to = count;\r\n                    }\r\n                    if (months.length > 0) {\r\n                        months[months.length - 1].to = count;\r\n                    }\r\n                    if (layout.cols.dirty) {\r\n                        angular.forEach(visibleWeeks, function (item, i) {\r\n                            if (i < weeks.length) {\r\n                                var $scope = getWeek(i, weeks[i], item);\r\n                                if (!$scope.$$phase) {\r\n                                    $scope.$digest();\r\n                                }\r\n                            }\r\n                        });\r\n                        while (visibleWeeks.length < weeks.length) {\r\n                            var $scope = getWeek(visibleWeeks.length, weeks[visibleWeeks.length]);\r\n                            var compiled = $compile(templateWeek)($scope, function (cloned) {\r\n                                compiled = cloned;\r\n                            });\r\n                            var $element = angular.element(compiled);\r\n                            weeksElement.append($element);\r\n                            visibleWeeks.push({\r\n                                element: $element,\r\n                                scope: $scope,\r\n                            });\r\n                        }\r\n                        angular.forEach(visibleMonths, function (item, i) {\r\n                            if (i < months.length) {\r\n                                var $scope = getMonth(i, months[i], item);\r\n                                if (!$scope.$$phase) {\r\n                                    $scope.$digest();\r\n                                }\r\n                            }\r\n                        });\r\n                        while (visibleMonths.length < months.length) {\r\n                            var $scope = getMonth(visibleMonths.length, months[visibleMonths.length]);\r\n                            var compiled = $compile(templateMonth)($scope, function (cloned) {\r\n                                compiled = cloned;\r\n                            });\r\n                            var $element = angular.element(compiled);\r\n                            monthsElement.append($element);\r\n                            visibleMonths.push({\r\n                                element: $element,\r\n                                scope: $scope,\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            function update() {\r\n                // console.log('update');\r\n                updateRows();\r\n                updateCols();\r\n                drawCells();\r\n                drawHeaders();\r\n                render();\r\n                redraw();\r\n            }\r\n\r\n            function render() {\r\n                var count = layout.rows.count * layout.cols.count,\r\n                    visibles = layout.visibles;\r\n                var USE_TRANSFORM = true;\r\n                angular.forEach(visibles, function (item, i) {\r\n                    var node = item.element[0];\r\n                    if (i < count) {\r\n                        node.style.width = (cols ? layout.cell.width : layout.table.width) + 'px';\r\n                        node.style.height = (rows ? layout.cell.height : layout.table.height) + 'px';\r\n                        var r = item.scope.$r;\r\n                        var c = item.scope.$c;\r\n                        if (USE_TRANSFORM) {\r\n                            transform(node, 'translateX(' + (c * layout.cell.width) + 'px) translateY(' + (r * layout.cell.height) + 'px)');\r\n                        } else {\r\n                            node.style.left = (c * layout.cell.width) + 'px';\r\n                            node.style.top = (r * layout.cell.height) + 'px';\r\n                            node.style.visibility = 'visible';\r\n                        }\r\n                    } else {\r\n                        if (USE_TRANSFORM) {\r\n                            transform(node, 'translateX(-1000px) translateY(-1000px)');\r\n                        } else {\r\n                            node.style.left = '0px';\r\n                            node.style.top = '0px';\r\n                            node.style.visibility = 'hidden';\r\n                        }\r\n                    }\r\n                });                \r\n                if (CALENDAR) {\r\n                    var mx = 0, wx = 0;\r\n                    angular.forEach(layout.visibleMonths, function (item, i) {\r\n                        var node = item.element[0];\r\n                        var width = Math.max(1, item.scope.$to - item.scope.$from) * layout.day.width;\r\n                        if (i < months.length) {\r\n                            node.style.width = width + 'px';\r\n                            node.style.height = layout.month.height + 'px';\r\n                            transform(node, 'translateX(' + mx + 'px) translateY(0px)');\r\n                            mx += width;\r\n                        } else {\r\n                            transform(node, 'translateX(-1000px) translateY(-1000px)');\r\n                        }\r\n                    });\r\n                    angular.forEach(layout.visibleWeeks, function (item, i) {\r\n                        var node = item.element[0];\r\n                        var width = Math.max(1, item.scope.$to - item.scope.$from) * layout.day.width;\r\n                        if (i < weeks.length) {\r\n                            node.style.width = width + 'px';\r\n                            node.style.height = layout.week.height + 'px';\r\n                            transform(node, 'translateX(' + wx + 'px) translateY(' + layout.month.height + 'px)');\r\n                            wx += width;\r\n                        } else {\r\n                            transform(node, 'translateX(-1000px) translateY(-1000px)');\r\n                        }\r\n                    });\r\n                    angular.forEach(layout.visibleDays, function (item, i) {\r\n                        var node = item.element[0];\r\n                        if (i < layout.cols.count) {\r\n                            node.style.width = (cols ? layout.day.width : layout.day.width) + 'px';\r\n                            node.style.height = (rows ? layout.day.height : layout.day.height) + 'px';\r\n                            var c = item.scope.$c;\r\n                            transform(node, 'translateX(' + (c * layout.day.width) + 'px) translateY(' + (layout.month.height + layout.week.height) + 'px)');\r\n                        } else {\r\n                            transform(node, 'translateX(-1000px) translateY(-1000px)');\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            function redraw() {\r\n                layout.table.x = Math.floor(layout.scroll.x / layout.cell.width) * layout.cell.width;\r\n                layout.table.y = Math.floor(layout.scroll.y / layout.cell.height) * layout.cell.height;\r\n                nodeTableInner.style.width = (layout.cols.has ? layout.cell.width * layout.cols.count : layout.grid.width) + 'px';\r\n                nodeTableInner.style.height = (layout.rows.has ? layout.cell.height * layout.rows.count : layout.grid.height) + 'px';\r\n                transform(nodeTableInner, 'translateX(' + layout.table.x + 'px) translateY(' + layout.table.y + 'px)');\r\n                if (CALENDAR) {\r\n                    var headerX = layout.table.x - layout.scroll.x;\r\n                    transform(nodeHeaderInner, 'translateX(' + headerX + 'px)');\r\n                }\r\n                log({\r\n                    scroll: layout.scroll,\r\n                    grid: layout.grid,\r\n                    rows: layout.rows.has ? layout.rows : null,\r\n                    cols: layout.cols.has ? layout.cols : null,\r\n                });\r\n            }\r\n\r\n            function transform(node, value) {\r\n                node.style.WebkitTransform =\r\n                    node.style.MozTransform =\r\n                    node.style.OTransform =\r\n                    node.style.MsTransform =\r\n                    node.style.transform =\r\n                    value;\r\n            }\r\n\r\n            function onRows() {\r\n                layout.rows.total = 0;\r\n                layout.table.height = 0;\r\n                if (rows) {\r\n                    layout.rows.total = rows.length;\r\n                    layout.table.height = layout.rows.total * layout.cell.height;\r\n                    layout.rows.has = true;\r\n                } else {\r\n                    layout.table.height = layout.grid.height;\r\n                    layout.rows.has = false;\r\n                }\r\n                if (rows && rows.length) {\r\n                    element.addClass('vertical');\r\n                } else {\r\n                    element.removeClass('vertical');\r\n                }\r\n                nodeSpacer.style.height = layout.table.height + 'px';\r\n            }\r\n\r\n            function onCols() {\r\n                layout.cols.total = 0;\r\n                layout.table.width = 0;\r\n                if (cols) {\r\n                    layout.cols.total = cols.length;\r\n                    layout.table.width = layout.cols.total * layout.cell.width;\r\n                    layout.cols.has = false;\r\n                } else {\r\n                    layout.table.width = layout.grid.width;\r\n                    layout.cols.has = false;\r\n                }\r\n                if (cols && cols.length) {\r\n                    element.addClass('horizontal');\r\n                } else {\r\n                    element.removeClass('horizontal');\r\n                }\r\n                nodeSpacer.style.width = layout.table.width + 'px';\r\n            }\r\n\r\n            function scrollToColumn(col) {\r\n                resize();\r\n                nodeTable.scrollLeft = (col * layout.cell.width);\r\n                // console.log('scrollToColumn', (layout.table.width - layout.grid.width), nodeTable.scrollLeft);\r\n                doScroll();\r\n            }\r\n\r\n            function scrollToX(x) {\r\n                nodeTable.scrollLeft = x;\r\n                // console.log('scrollTo');\r\n                doScroll();\r\n            }\r\n            function scrollToY(y) {\r\n                nodeTable.scrollTop = y;\r\n                // console.log('scrollTo');\r\n                doScroll();\r\n            }\r\n            function scrollTo($layout) {\r\n                nodeTable.scrollLeft = $layout.scroll.x;\r\n                nodeTable.scrollTop = $layout.scroll.y;\r\n                // console.log('scrollTo');\r\n                doScroll();\r\n            }\r\n\r\n            function doScroll() {\r\n                if (rows) {\r\n                    layout.rows.total = rows.length;\r\n                    layout.table.height = layout.rows.total * layout.cell.height;\r\n                } else {\r\n                    layout.table.height = layout.grid.height;\r\n                }\r\n                if (cols) {\r\n                    layout.cols.total = cols.length;\r\n                    layout.table.width = layout.cols.total * layout.cell.width;\r\n                } else {\r\n                    layout.table.width = layout.grid.width;\r\n                }\r\n                layout.scroll.x = Math.max(0, Math.min((layout.table.width - layout.grid.width), nodeTable.scrollLeft));\r\n                layout.scroll.y = Math.max(0, Math.min((layout.table.height - layout.grid.height), nodeTable.scrollTop));\r\n                // console.log(layout.scroll.x, layout.scroll.y, layout.table.width, layout.grid.width);\r\n                // console.log('doScroll', (layout.table.width - layout.grid.width), nodeTable.scrollLeft);\r\n                update();\r\n            }\r\n\r\n            function onScroll() {\r\n                doScroll();\r\n                // console.log('ngrid.doScroll');\r\n                if (angular.isFunction(layout.onScroll)) {\r\n                    layout.onScroll(layout);\r\n                }\r\n            }\r\n\r\n            function resize() {\r\n                var WW = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\r\n                var WH = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n                layout.grid.width = layout.table.width = Math.min(nodeTable.offsetWidth, WW);\r\n                layout.grid.height = layout.table.height = Math.min(nodeTable.offsetHeight, WH);\r\n            }\r\n            // resize fires on window resize and on scope update      \r\n            function onResize() {\r\n                resize();\r\n                update();\r\n            }\r\n\r\n            function log(obj) {\r\n                layout.info = JSON.stringify(obj);\r\n                nodeInfo.innerHTML = layout.info;\r\n            }\r\n\r\n            var down, move, diff, dragging, sx, sy;\r\n\r\n            function onStart(e) {\r\n                down = Utils.getTouch(e);\r\n                sx = nodeTable.scrollLeft;\r\n                sy = nodeTable.scrollTop;\r\n                addDragListeners();\r\n                return false;\r\n            }\r\n\r\n            function onMove(e) {\r\n                move = Utils.getTouch(e);\r\n                diff = down.difference(move);\r\n                if (!dragging && diff.power() > 25) {\r\n                    dragging = true;\r\n                    element.addClass('dragging');\r\n                }\r\n                if (dragging) {\r\n                    nodeTable.scrollLeft = sx - diff.x;\r\n                    // nodeTable.scrollTop = sy - diff.y;\r\n                    onScroll();\r\n                }\r\n                return false;\r\n            }\r\n\r\n            function onEnd(e) {\r\n                if (dragging) {\r\n                    dragging = false;\r\n                    element.removeClass('dragging');\r\n                }\r\n                removeDragListeners();\r\n                return false;\r\n            }\r\n\r\n            function addDragListeners() {\r\n                angular.element($window).on('touchmove mousemove', onMove);\r\n                angular.element($window).on('touchend mouseup', onEnd);\r\n            };\r\n\r\n            function removeDragListeners() {\r\n                angular.element($window).off('touchmove mousemove', onMove);\r\n                angular.element($window).off('touchend mouseup', onEnd);\r\n            };\r\n\r\n            function addListeners() {\r\n                angular.element(nodeHeader).on('touchstart mousedown', onStart);\r\n                angular.element(nodeTable).on('scroll', onScroll);\r\n                angular.element($window).on('resize', onResize);\r\n            };\r\n\r\n            function removeListeners() {\r\n                angular.element(nodeHeader).off('touchstart mousedown', onStart);\r\n                angular.element(nodeTable).off('scroll', onScroll);\r\n                angular.element($window).off('resize', onResize);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n                removeDragListeners();\r\n            });\r\n            addListeners();\r\n\r\n            // WATCH ROWS\r\n            scope.$watchCollection(attributes.ngridRows, function (value, oldValue) {\r\n                // console.log('ngrid.$watchCollection.ngridRows');\r\n                rows = value;\r\n                onRows();\r\n                onResize();\r\n            });\r\n\r\n            // WATCH COLS\r\n            if (CALENDAR) {\r\n                cols = new Array(CALENDAR_SIZE * 2);\r\n                onCols();\r\n                setTimeout(function () {\r\n                    scrollToColumn(CALENDAR_SIZE);\r\n                });\r\n            } else {\r\n                scope.$watch(attributes.ngridCols, function (value) {\r\n                    // console.log('ngrid.$watchCollection.ngridCols');\r\n                    cols = value;\r\n                    onCols();\r\n                    onResize();\r\n                });\r\n            }\r\n\r\n            // WATCH OPTIONS\r\n            scope.$watch(attributes.ngrid, function (value) {\r\n                if (angular.isObject(value)) {\r\n                    // ok but add a schema (keys)\r\n                    layout.scrollTo = scrollTo;\r\n                    layout.scrollToX = scrollToX;\r\n                    layout.scrollToY = scrollToY;\r\n                    var keys = ['onScroll', 'scrollTo', 'scrollToX', 'scrollToY'];\r\n                    angular.forEach(keys, function (key) {\r\n                        layout[key] = value[key] || layout[key];\r\n                        value[key] = value[key] || layout[key];\r\n                        if (CALENDAR) {\r\n                            value.getAbsoluteCol = getAbsoluteCol;\r\n                        }\r\n                    });\r\n                    // angular.extend(layout, value);\r\n                    onResize();\r\n                    // console.log('ngrid.$watch.ngrid', layout);\r\n                }\r\n            });\r\n        }\r\n    }\r\n}]);\n/* global angular, module */\r\n\r\nmodule.filter('shortName', ['$filter', function ($filter) {\r\n    function toTitleCase(str) {\r\n        return str.replace(/\\w\\S*/g, function (txt) { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });\r\n    }\r\n    return function (value) {\r\n        if (!value) {\r\n            return '';\r\n        }\r\n        if (value.indexOf(' .') === value.length - 2) {\r\n            value = value.split(' .').join('');\r\n        }\r\n        /*\r\n        var splitted;\r\n        if (value.indexOf('.') !== -1) {\r\n            splitted = value.split('.');\r\n        } else {\r\n            splitted = value.split(' ');\r\n        }\r\n        */\r\n        var splitted = value.split(' ');\r\n        var firstName = splitted.shift();\r\n        if (splitted.length) {\r\n            var lastName = splitted.join(' ');\r\n            return firstName.substr(0, 1).toUpperCase() + '.' + toTitleCase(lastName);\r\n        } else {\r\n            return firstName;\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customCurrency', ['$filter', function ($filter) {\r\n    var legacyFilter = $filter('currency');\r\n    return function (cost, currency) {\r\n        return legacyFilter(cost * currency.ratio, currency.formatting);\r\n    }\r\n}]);\r\n\r\nmodule.filter('customNumber', ['$filter', function ($filter) {\r\n    var filter = $filter('number');\r\n    return function (value, precision, unit) {\r\n        unit = unit || '';\r\n        return (value ? filter(value, precision) + unit : '-');\r\n    }\r\n}]);\r\n\r\nmodule.filter('customHours', [function () {\r\n    return function (value) {\r\n        if (value) {\r\n            var hours = Math.floor(value);\r\n            var minutes = Math.floor((value - hours) * 60);\r\n            var label = hours ? hours + ' H' : '';\r\n            label += minutes ? ' ' + minutes + ' m' : '';\r\n            return label;\r\n        } else {\r\n            return '-';\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customDate', ['$filter', function ($filter) {\r\n    var filter = $filter('date');\r\n    return function (value, format, timezone) {\r\n        return value ? filter(value, format, timezone) : '-';\r\n    }\r\n}]);\r\n\r\nmodule.filter('customTime', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseTime(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customDigital', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseHour(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customString', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        return value ? value : (placeholder ? placeholder : '-');\r\n    }\r\n}]);\r\n\r\nmodule.filter('customEnum', function () {\r\n    return function (val) {\r\n        val = val + 1;\r\n        return val < 10 ? '0' + val : val;\r\n    };\r\n});\r\n\n/* global angular, module */\r\n\r\nmodule.factory('Md5', [function () {\r\n\r\n    var hex_chr = '0123456789abcdef'.split('');\r\n\r\n    function cycle(x, k) {\r\n        var a = x[0], b = x[1], c = x[2], d = x[3];\r\n\r\n        a = ff(a, b, c, d, k[0], 7, -680876936);\r\n        d = ff(d, a, b, c, k[1], 12, -389564586);\r\n        c = ff(c, d, a, b, k[2], 17, 606105819);\r\n        b = ff(b, c, d, a, k[3], 22, -1044525330);\r\n        a = ff(a, b, c, d, k[4], 7, -176418897);\r\n        d = ff(d, a, b, c, k[5], 12, 1200080426);\r\n        c = ff(c, d, a, b, k[6], 17, -1473231341);\r\n        b = ff(b, c, d, a, k[7], 22, -45705983);\r\n        a = ff(a, b, c, d, k[8], 7, 1770035416);\r\n        d = ff(d, a, b, c, k[9], 12, -1958414417);\r\n        c = ff(c, d, a, b, k[10], 17, -42063);\r\n        b = ff(b, c, d, a, k[11], 22, -1990404162);\r\n        a = ff(a, b, c, d, k[12], 7, 1804603682);\r\n        d = ff(d, a, b, c, k[13], 12, -40341101);\r\n        c = ff(c, d, a, b, k[14], 17, -1502002290);\r\n        b = ff(b, c, d, a, k[15], 22, 1236535329);\r\n\r\n        a = gg(a, b, c, d, k[1], 5, -165796510);\r\n        d = gg(d, a, b, c, k[6], 9, -1069501632);\r\n        c = gg(c, d, a, b, k[11], 14, 643717713);\r\n        b = gg(b, c, d, a, k[0], 20, -373897302);\r\n        a = gg(a, b, c, d, k[5], 5, -701558691);\r\n        d = gg(d, a, b, c, k[10], 9, 38016083);\r\n        c = gg(c, d, a, b, k[15], 14, -660478335);\r\n        b = gg(b, c, d, a, k[4], 20, -405537848);\r\n        a = gg(a, b, c, d, k[9], 5, 568446438);\r\n        d = gg(d, a, b, c, k[14], 9, -1019803690);\r\n        c = gg(c, d, a, b, k[3], 14, -187363961);\r\n        b = gg(b, c, d, a, k[8], 20, 1163531501);\r\n        a = gg(a, b, c, d, k[13], 5, -1444681467);\r\n        d = gg(d, a, b, c, k[2], 9, -51403784);\r\n        c = gg(c, d, a, b, k[7], 14, 1735328473);\r\n        b = gg(b, c, d, a, k[12], 20, -1926607734);\r\n\r\n        a = hh(a, b, c, d, k[5], 4, -378558);\r\n        d = hh(d, a, b, c, k[8], 11, -2022574463);\r\n        c = hh(c, d, a, b, k[11], 16, 1839030562);\r\n        b = hh(b, c, d, a, k[14], 23, -35309556);\r\n        a = hh(a, b, c, d, k[1], 4, -1530992060);\r\n        d = hh(d, a, b, c, k[4], 11, 1272893353);\r\n        c = hh(c, d, a, b, k[7], 16, -155497632);\r\n        b = hh(b, c, d, a, k[10], 23, -1094730640);\r\n        a = hh(a, b, c, d, k[13], 4, 681279174);\r\n        d = hh(d, a, b, c, k[0], 11, -358537222);\r\n        c = hh(c, d, a, b, k[3], 16, -722521979);\r\n        b = hh(b, c, d, a, k[6], 23, 76029189);\r\n        a = hh(a, b, c, d, k[9], 4, -640364487);\r\n        d = hh(d, a, b, c, k[12], 11, -421815835);\r\n        c = hh(c, d, a, b, k[15], 16, 530742520);\r\n        b = hh(b, c, d, a, k[2], 23, -995338651);\r\n\r\n        a = ii(a, b, c, d, k[0], 6, -198630844);\r\n        d = ii(d, a, b, c, k[7], 10, 1126891415);\r\n        c = ii(c, d, a, b, k[14], 15, -1416354905);\r\n        b = ii(b, c, d, a, k[5], 21, -57434055);\r\n        a = ii(a, b, c, d, k[12], 6, 1700485571);\r\n        d = ii(d, a, b, c, k[3], 10, -1894986606);\r\n        c = ii(c, d, a, b, k[10], 15, -1051523);\r\n        b = ii(b, c, d, a, k[1], 21, -2054922799);\r\n        a = ii(a, b, c, d, k[8], 6, 1873313359);\r\n        d = ii(d, a, b, c, k[15], 10, -30611744);\r\n        c = ii(c, d, a, b, k[6], 15, -1560198380);\r\n        b = ii(b, c, d, a, k[13], 21, 1309151649);\r\n        a = ii(a, b, c, d, k[4], 6, -145523070);\r\n        d = ii(d, a, b, c, k[11], 10, -1120210379);\r\n        c = ii(c, d, a, b, k[2], 15, 718787259);\r\n        b = ii(b, c, d, a, k[9], 21, -343485551);\r\n\r\n        x[0] = add32(a, x[0]);\r\n        x[1] = add32(b, x[1]);\r\n        x[2] = add32(c, x[2]);\r\n        x[3] = add32(d, x[3]);\r\n\r\n    }\r\n\r\n    function cmn(q, a, b, x, s, t) {\r\n        a = add32(add32(a, q), add32(x, t));\r\n        return add32((a << s) | (a >>> (32 - s)), b);\r\n    }\r\n\r\n    function ff(a, b, c, d, x, s, t) {\r\n        return cmn((b & c) | ((~b) & d), a, b, x, s, t);\r\n    }\r\n\r\n    function gg(a, b, c, d, x, s, t) {\r\n        return cmn((b & d) | (c & (~d)), a, b, x, s, t);\r\n    }\r\n\r\n    function hh(a, b, c, d, x, s, t) {\r\n        return cmn(b ^ c ^ d, a, b, x, s, t);\r\n    }\r\n\r\n    function ii(a, b, c, d, x, s, t) {\r\n        return cmn(c ^ (b | (~d)), a, b, x, s, t);\r\n    }\r\n\r\n    function md51(s) {\r\n        var txt = '';\r\n        var n = s.length,\r\n        state = [1732584193, -271733879, -1732584194, 271733878], i;\r\n        for (i = 64; i <= s.length; i += 64) {\r\n            cycle(state, md5blk(s.substring(i - 64, i)));\r\n        }\r\n        s = s.substring(i - 64);\r\n        var tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        for (i = 0; i < s.length; i++)\r\n            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\r\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\r\n        if (i > 55) {\r\n            cycle(state, tail);\r\n            for (i = 0; i < 16; i++) tail[i] = 0;\r\n        }\r\n        tail[14] = n * 8;\r\n        cycle(state, tail);\r\n        return state;\r\n    }\r\n\r\n    /* there needs to be support for Unicode here,\r\n        * unless we pretend that we can redefine the MD-5\r\n        * algorithm for multi-byte characters (perhaps\r\n        * by adding every four 16-bit characters and\r\n        * shortening the sum to 32 bits). Otherwise\r\n        * I suggest performing MD-5 as if every character\r\n        * was two bytes--e.g., 0040 0025 = @%--but then\r\n        * how will an ordinary MD-5 sum be matched?\r\n        * There is no way to standardize text to something\r\n        * like UTF-8 before transformation; speed cost is\r\n        * utterly prohibitive. The JavaScript standard\r\n        * itself needs to look at this: it should start\r\n        * providing access to strings as preformed UTF-8\r\n        * 8-bit unsigned value arrays.\r\n        */\r\n    function md5blk(s) { /* I figured global was faster.   */\r\n        var md5blks = [], i; /* Andy King said do it this way. */\r\n        for (i = 0; i < 64; i += 4) {\r\n            md5blks[i >> 2] = s.charCodeAt(i)\r\n            + (s.charCodeAt(i + 1) << 8)\r\n            + (s.charCodeAt(i + 2) << 16)\r\n            + (s.charCodeAt(i + 3) << 24);\r\n        }\r\n        return md5blks;\r\n    }\r\n\r\n    function rhex(n) {\r\n        var s = '', j = 0;\r\n        for (; j < 4; j++)\r\n            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F]\r\n            + hex_chr[(n >> (j * 8)) & 0x0F];\r\n        return s;\r\n    }\r\n\r\n    function hex(x) {\r\n        for (var i = 0; i < x.length; i++)\r\n            x[i] = rhex(x[i]);\r\n        return x.join('');\r\n    }\r\n\r\n    /* this function is much faster,\r\n    so if possible we use it. Some IEs\r\n    are the only ones I know of that\r\n    need the idiotic second function,\r\n    generated by an if clause.  */\r\n    function add32(a, b) {\r\n        return (a + b) & 0xFFFFFFFF;\r\n    }\r\n\r\n    function Md5() { }\r\n    Md5.encode = function (string) {\r\n        return hex(md51(string));\r\n    }\r\n    if (Md5.encode('hello') !== '5d41402abc4b2a76b9719d911017c592') {\r\n        add32 = function (x, y) {\r\n            var lsw = (x & 0xFFFF) + (y & 0xFFFF),\r\n            msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n            return (msw << 16) | (lsw & 0xFFFF);\r\n        }\r\n    }\r\n    return Md5;\r\n}]);\r\n\r\nmodule.factory('Utils', ['$compile', '$controller', 'Vector', 'Md5', function ($compile, $controller, Vector, Md5) {\r\n    (function () {\r\n        // POLYFILL window.requestAnimationFrame\r\n        var lastTime = 0;\r\n        var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n            window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame']\r\n                                       || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n        }\r\n        if (!window.requestAnimationFrame) {\r\n            window.requestAnimationFrame = function (callback, element) {\r\n                var currTime = new Date().getTime();\r\n                var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n                var id = window.setTimeout(function () { callback(currTime + timeToCall); }, timeToCall);\r\n                lastTime = currTime + timeToCall;\r\n                return id;\r\n            };\r\n        }\r\n        if (!window.cancelAnimationFrame) {\r\n            window.cancelAnimationFrame = function (id) {\r\n                clearTimeout(id);\r\n            };\r\n        }\r\n    }());\r\n    (function () {\r\n        // POLYFILL Array.prototype.reduce\r\n        // Production steps of ECMA-262, Edition 5, 15.4.4.21\r\n        // Reference: http://es5.github.io/#x15.4.4.21\r\n        // https://tc39.github.io/ecma262/#sec-array.prototype.reduce\r\n        if (!Array.prototype.reduce) {\r\n            Object.defineProperty(Array.prototype, 'reduce', {\r\n                value: function (callback) {// , initialvalue\r\n                    if (this === null) {\r\n                        throw new TypeError('Array.prototype.reduce called on null or undefined');\r\n                    }\r\n                    if (typeof callback !== 'function') {\r\n                        throw new TypeError(callback + ' is not a function');\r\n                    }\r\n                    var o = Object(this);\r\n                    var len = o.length >>> 0;\r\n                    var k = 0;\r\n                    var value;\r\n                    if (arguments.length == 2) {\r\n                        value = arguments[1];\r\n                    } else {\r\n                        while (k < len && !(k in o)) {\r\n                            k++;\r\n                        }\r\n                        if (k >= len) {\r\n                            throw new TypeError('Reduce of empty array with no initial value');\r\n                        }\r\n                        value = o[k++];\r\n                    }\r\n                    while (k < len) {\r\n                        if (k in o) {\r\n                            value = callback(value, o[k], k, o);\r\n                        }\r\n                        k++;\r\n                    }\r\n                    return value;\r\n                }\r\n            });\r\n        }\r\n    }());\r\n    var _isTouch;\r\n    function isTouch() {\r\n        if (!_isTouch) {\r\n            _isTouch = {\r\n                value: ('ontouchstart' in window || 'onmsgesturechange' in window)\r\n            }\r\n        }\r\n        // console.log(_isTouch);\r\n        return _isTouch.value;\r\n    }\r\n    function getTouch(e, previous) {\r\n        var t = new Vector();\r\n        if (e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel') {\r\n            var touch = null;\r\n            var event = e.originalEvent ? e.originalEvent : e;\r\n            var touches = event.touches.length ? event.touches : event.changedTouches;\r\n            if (touches && touches.length) {\r\n                touch = touches[0];\r\n            }\r\n            if (touch) {\r\n                t.x = touch.pageX;\r\n                t.y = touch.pageY;\r\n            }\r\n        } else if (e.type == 'click' || e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover' || e.type == 'mouseout' || e.type == 'mouseenter' || e.type == 'mouseleave') {\r\n            t.x = e.pageX;\r\n            t.y = e.pageY;\r\n        }\r\n        if (previous) {\r\n            t.s = Vector.difference(previous, t);\r\n        }\r\n        t.type = e.type;\r\n        return t;\r\n    }\r\n    function getRelativeTouch(element, point) {\r\n        var rect = element[0].getBoundingClientRect();\r\n        var e = new Vector(rect.left, rect.top);\r\n        return Vector.difference(e, point);\r\n    }\r\n    function getClosest(el, selector) {\r\n        var matchesFn, parent;\r\n        ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\r\n            if (typeof document.body[fn] == 'function') {\r\n                matchesFn = fn;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        if (el[matchesFn](selector)) {\r\n            return el;\r\n        }\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent[matchesFn](selector)) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n    function getClosestElement(el, target) {\r\n        var matchesFn, parent;\r\n        if (el === target) {\r\n            return el;\r\n        }\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent === target) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n    var getNow = Date.now || function () {\r\n        return new Date().getTime();\r\n    };\r\n    function throttle(func, wait, options) {\r\n        // Returns a function, that, when invoked, will only be triggered at most once\r\n        // during a given window of time. Normally, the throttled function will run\r\n        // as much as it can, without ever going more than once per `wait` duration;\r\n        // but if you'd like to disable the execution on the leading edge, pass\r\n        // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n        var context, args, result;\r\n        var timeout = null;\r\n        var previous = 0;\r\n        if (!options) options = {};\r\n        var later = function () {\r\n            previous = options.leading === false ? 0 : getNow();\r\n            timeout = null;\r\n            result = func.apply(context, args);\r\n            if (!timeout) context = args = null;\r\n        };\r\n        return function () {\r\n            var now = getNow();\r\n            if (!previous && options.leading === false) previous = now;\r\n            var remaining = wait - (now - previous);\r\n            context = this;\r\n            args = arguments;\r\n            if (remaining <= 0 || remaining > wait) {\r\n                if (timeout) {\r\n                    clearTimeout(timeout);\r\n                    timeout = null;\r\n                }\r\n                previous = now;\r\n                result = func.apply(context, args);\r\n                if (!timeout) context = args = null;\r\n            } else if (!timeout && options.trailing !== false) {\r\n                timeout = setTimeout(later, remaining);\r\n            }\r\n            return result;\r\n        };\r\n    }\r\n    function where(array, query) {\r\n        var found = null;\r\n        if (array) {\r\n            angular.forEach(array, function (item) {\r\n                var has = true;\r\n                angular.forEach(query, function (value, key) {\r\n                    has = has && item[key] === value;\r\n                });\r\n                if (has) {\r\n                    found = item;\r\n                }\r\n            });\r\n        }\r\n        return found;\r\n    }\r\n    function compileController(scope, element, html, data) {\r\n        // console.log('Utils.compileController', element);\r\n        element.html(html);\r\n        var link = $compile(element.contents());\r\n        if (data.controller) {\r\n            var $scope = scope.$new();\r\n            angular.extend($scope, data);\r\n            var controller = $controller(data.controller, { $scope: $scope });\r\n            if (data.controllerAs) {\r\n                scope[data.controllerAs] = controller;\r\n            }\r\n            element.data('$ngControllerController', controller);\r\n            element.children().data('$ngControllerController', controller);\r\n            scope = $scope;\r\n        }\r\n        link(scope);\r\n    }\r\n    var ua = window.navigator.userAgent.toLowerCase();\r\n    var safari = ua.indexOf('safari') !== -1 && ua.indexOf('chrome') === -1;\r\n    var msie = ua.indexOf('trident') !== -1 || ua.indexOf('edge') !== -1 || ua.indexOf('msie') !== -1;\r\n    var chrome = !safari && !msie && ua.indexOf('chrome') !== -1;\r\n    var mobile = ua.indexOf('mobile') !== -1;\r\n    function Utils() {\r\n    }\r\n    function reverseSortOn(key) {\r\n        return function (a, b) {\r\n            if (a[key] < b[key]) {\r\n                return 1;\r\n            }\r\n            if (a[key] > b[key]) {\r\n                return -1;\r\n            }\r\n            // a must be equal to b\r\n            return 0;\r\n        }\r\n    }\r\n    function format(string, prepend, expression) {\r\n        string = string || '';\r\n        prepend = prepend || '';\r\n        var splitted = string.split(',');\r\n        if (splitted.length > 1) {\r\n            var formatted = splitted.shift();\r\n            angular.forEach(splitted, function (value, index) {\r\n                if (expression) {\r\n                    formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\r\n                } else {\r\n                    formatted = formatted.split('{' + index + '}').join(prepend + value);\r\n                }\r\n            });\r\n            if (expression) {\r\n                return '\\'' + formatted + '\\'';\r\n            } else {\r\n                return formatted;\r\n            }\r\n        } else {\r\n            return prepend + string;\r\n        }\r\n    }\r\n    function reducer(o, key) {\r\n        return o[key];\r\n    }\r\n    function reducerSetter(o, key, value) {\r\n        if (typeof key == 'string') {\r\n            return reducerSetter(o, key.split('.'), value);\r\n        } else if (key.length == 1 && value !== undefined) {\r\n            return o[key[0]] = value;\r\n        } else if (key.length == 0) {\r\n            return o;\r\n        } else {\r\n            return reducerSetter(o[key[0]], key.slice(1), value);\r\n        }\r\n    }\r\n    function reducerAdder(o, key, value) {\r\n        if (typeof key == 'string') {\r\n            return reducerAdder(o, key.split('.'), value);\r\n        } else if (key.length == 1 && value !== undefined) {\r\n            return (o[key[0]] += value);\r\n        } else if (key.length == 0) {\r\n            return o;\r\n        } else {\r\n            return reducerAdder(o[key[0]], key.slice(1), value);\r\n        }\r\n    }\r\n    Utils.reverseSortOn = reverseSortOn;\r\n    Utils.getTouch = getTouch;\r\n    Utils.getRelativeTouch = getRelativeTouch;\r\n    Utils.getClosest = getClosest;\r\n    Utils.getClosestElement = getClosestElement;\r\n    Utils.throttle = throttle;\r\n    Utils.where = where;\r\n    Utils.format = format;\r\n    Utils.compileController = compileController;\r\n    Utils.reducer = reducer;\r\n    Utils.reducerSetter = reducerSetter;\r\n    Utils.reducerAdder = reducerAdder;\r\n    Utils.toMd5 = function (string) {\r\n        return Md5.encode(string);\r\n    };\r\n    Utils.ua = {\r\n        safari: safari,\r\n        msie: msie,\r\n        chrome: chrome,\r\n        mobile: mobile,\r\n    };\r\n    angular.forEach(Utils.ua, function (value, key) {\r\n        if (value) {\r\n            angular.element(document.getElementsByTagName('body')).addClass(key);\r\n        }\r\n    });\r\n    return Utils;\r\n}]);\r\n\r\nmodule.factory('Vector', function () {\r\n    function Vector(x, y) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n    }\r\n    Vector.make = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.size = function (a) {\r\n        return Math.sqrt(a.x * a.x + a.y * a.y);\r\n    };\r\n    Vector.normalize = function (a) {\r\n        var l = Vector.size(a);\r\n        a.x /= l;\r\n        a.y /= l;\r\n        return a;\r\n    };\r\n    Vector.incidence = function (a, b) {\r\n        var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\r\n        // if (angle < 0) angle += 2 * Math.PI;\r\n        // angle = Math.min(angle, (Math.PI * 2 - angle));\r\n        return angle;\r\n    };\r\n    Vector.distance = function (a, b) {\r\n        return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\r\n    };\r\n    Vector.cross = function (a, b) {\r\n        return (a.x * b.y) - (a.y * b.x);\r\n    };\r\n    Vector.difference = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.power = function (a, b) {\r\n        var x = Math.abs(b.x - a.x);\r\n        var y = Math.abs(b.y - a.y);\r\n        return (x + y) / 2;\r\n    };\r\n    Vector.prototype = {\r\n        size: function () {\r\n            return Vector.size(this);\r\n        },\r\n        normalize: function () {\r\n            return Vector.normalize(this);\r\n        },\r\n        incidence: function (b) {\r\n            return Vector.incidence(this, b);\r\n        },\r\n        cross: function (b) {\r\n            return Vector.cross(this, b);\r\n        },\r\n        distance: function (b) {\r\n            return Vector.distance(this, b);\r\n        },\r\n        difference: function (b) {\r\n            return Vector.difference(this, b);\r\n        },\r\n        power: function () {\r\n            return (Math.abs(this.x) + Math.abs(this.y)) / 2;\r\n        },\r\n        towards: function (b, friction) {\r\n            friction = friction || 0.125;\r\n            this.x += (b.x - this.x) * friction;\r\n            this.y += (b.y - this.y) * friction;\r\n            return this;\r\n        },\r\n        add: function (b) {\r\n            this.x += b.x;\r\n            this.y += b.y;\r\n            return this;\r\n        },\r\n        friction: function (b) {\r\n            this.x *= b;\r\n            this.y *= b;\r\n            return this;\r\n        },\r\n        copy: function (b) {\r\n            return new Vector(this.x, this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + '}';\r\n        },\r\n    };\r\n    return Vector;\r\n});\r\n\n/* global angular, module */\r\n\n//HEAD \n(function(app) {\ntry { app = angular.module(\"ngrid\"); }\ncatch(err) { app = angular.module(\"ngrid\", []); }\napp.run([\"$templateCache\", function($templateCache) {\n\"use strict\";\n\n$templateCache.put(\"ngrid/partials/ngrid\",\"<div class=\\\"ngrid\\\">\\n\" +\n    \"    <div class=\\\"ngrid-header\\\">\\n\" +\n    \"        <div class=\\\"ngrid-inner\\\">\\n\" +\n    \"            <div class=\\\"ngrid-months\\\"></div>\\n\" +\n    \"            <div class=\\\"ngrid-weeks\\\"></div>\\n\" +\n    \"            <div class=\\\"ngrid-days\\\"></div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"ngrid-table\\\">\\n\" +\n    \"        <div class=\\\"ngrid-spacer\\\"></div>\\n\" +\n    \"        <div class=\\\"ngrid-inner\\\" ng-transclude></div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"ngrid-footer\\\"></div>\\n\" +\n    \"    <div class=\\\"ngrid-info\\\"></div>\\n\" +\n    \"</div>\")\n}]);\n})();\n\r\n})(window, window.angular);\r\n"]}